{% extends "globus-portal-framework/v2/base.html" %}

{% load static %}
{% load index_template %}

{% block title %}Transfer{% endblock %}

{% block headextras %}
<link rel="stylesheet" type="text/css" href='/static/js/transfer/build/globus.css'></script>
{% endblock headextras %}

{%block body%}
<div class="row">
    <div style="margin-top: 30px; margin-left: auto; margin-right: auto; width:1303.33px">
            <h5>Source Node</h5>
            <select id="mySelect" class="form-control">

                {% if collection_id %}
                    <option value="{{collection_id}}"> {{collection_name}} </option>

                {%elif collection_id is null %}
                    <option value="" disabled selected>Choose a collection</option>
                    {% for collection in collections %}
                        <option value= "{{collection.id}}">{{collection.name}}</option>
                    {% empty %}
                    <div class="alert alert-primary" role="alert">
                        No collections configured for this portal! Check settings to add them.
                    </div>
                    {% endfor %}

                {% endif %}
            </select>
    </div>
</div>

<script id='transfer-config' type='application/json'>
    {
        "portalEndpointID": "{{ collection_id }}"
    }
</script>

<div id="transfer">
    <!-- React components are mounted here -->
</div>
<script src='/static/js/transfer/build/globus.js' type='application/javascript'></script>

<script>
    let mySelect = document.getElementById("mySelect");

    mySelect.onchange = (event)=>{
        let value = event.target.value;
        let redirectTarget = `http://[[settings.hostname]]/transfers/${value}/`;
        window.location = redirectTarget; 
    };
</script>





{% endblock %}